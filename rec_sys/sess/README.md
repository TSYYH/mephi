Посмотреть работу можно по [ссылке](./Сырников_sess.ipynb)

# Итоговый проект: разработка гибридной системы рекомендаций книг с нейросетевыми моделями

## Этап 1: Улучшенная подготовка данных + Этап 2. Построение гибридной системы

Система реализует гибридный подход к рекомендациям, объединяя коллаборативную, контентную и популярностную модели в едином пайплайне.

1. Входные данные

Логи взаимодействий пользователей

Контентные признаки книг (TF-IDF -> SVD эмбеддинги)

Агрегированные признаки пользователей и книг

Модель коллаборативной фильтрации (SVD)

2. Представления

Эмбеддинги книг: по текстовым признакам

Контентный профиль пользователя: среднее эмбеддингов прочитанных книг

Явное выделение cold-start пользователей по числу взаимодействий

3. Генерация кандидатов

Для каждого пользователя формируется пул кандидатов как объединение:

популярных книг,

контентно похожих книг,

SVD-рекомендаций (только для не-cold пользователей)

С прочитанных книг фильтрация выполняется заранее.

4. Скоринг (взвешенный ансамбль)

Для каждого кандидата считается итоговый скор:

SVD-предсказание,

косинусная близость (content),

нормализованная популярность.

Вклады моделей объединяются взвешенным усреднением, при cold-start вклад SVD отключается.

5. Ранжирование и выдача

Кандидаты сортируются по итоговому скору

Возвращается Top-K рекомендаций

Применение (возврат book_id):

<img width="306" height="302" alt="image" src="https://github.com/user-attachments/assets/91fca987-479b-4112-b54b-19afd86ef224" />


---

# Этап 3. Оценка и оптимизация

Сравнение гибридной системы с отдельными моделями (Выводы в конце):

<img width="282" height="223" alt="image" src="https://github.com/user-attachments/assets/d65d76d0-9052-487d-8292-bb77c177aab2" />

Метрики на разных сегментах пользователей:

<img width="585" height="503" alt="image" src="https://github.com/user-attachments/assets/4ff448ce-228e-4963-a2dd-a204830cdedd" />

<img width="593" height="503" alt="image" src="https://github.com/user-attachments/assets/af126489-3638-45a1-98e8-f4018e8c9b2a" />

<img width="595" height="506" alt="image" src="https://github.com/user-attachments/assets/dddeb926-a249-4250-b5bc-a0d36bac47b1" />

Cold - новые пользователи

Для cold-пользователей контентная модель доминирует: она использует информацию о книге (теги, описание) и не требует истории взаимодействий. Hybrid здесь показывает средний результат, потому что SVD и Popularity его портят.

Medium - умеренно активные

Content всё ещё даёт хороший результат, но SVD уже начинает проявлять себя. ItemCF не справляется с разреженностью (или страдает реализация).

Active - много взаимодействий

Для активных пользователей гибридная система даёт лучший результат: SVD начинает активно помогать, Content поддерживает рекомендации по новым книгам, Popularity добавляет стабильно популярные позиции

# Оптимизация весов в гибридной модели

Лучшие веса + метрики:

<img width="320" height="294" alt="image" src="https://github.com/user-attachments/assets/b490a3ae-33e9-46b0-91fc-a57fb9ac6755" />

<img width="582" height="566" alt="image" src="https://github.com/user-attachments/assets/d3159f38-f1e6-426b-bb96-39906e3e90dd" />

# Выводы

Popularity - рекомендует одни и те же книги всем пользователям иногда попадая в релевантные книги. Неперсонализирована, и в результате маленькие метрики.

ItemCF - худшее качество, возможно из-за высокой разреженности матрицы user-book, слабое перекрытие. Или страдает реализация.

SVD - моделирует латентные предпочтения  поользователей и книг, менее чувствителен к разреженности, но плохо справляется с холодным стартом. Стабильно метрики выше чем Popularity b ItemCF.

Content - превосходит SVD по всем метрикам. Хороша для новых пользователей и книг так как не зависит от взаимодействий.

Hybrid - берет лучшие стороны моделей: Content - против холодного старта, SVD - персонализация для активный пользователей, Popularity - популярное для всех. В итоге метрики выше чем у одиночных моделей.

OptWeightHybrid в сравнении с Hybrid: +63% Precision, +74% Recall, +57% nDCG. В результате оптимизации веса моделей адаптировались под структуру данных. В результате вклад каждой модели усилился для своей ниши.

---

Лучшая модель - OptWeightHybrid. Она устойчива к холодному старту, улучшает ранжирование, расширяется новыми признаками. Но для стабильной работы должно быть хорошее качество текстовых эмбеддингов
